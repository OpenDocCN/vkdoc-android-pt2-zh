## 第十三章

## 发布您的游戏

成为 Android 游戏开发者的最后一步是把你的游戏带给你的玩家。有两条可能的路线:

*   从你的项目的`bin/`文件夹中取出`APK`文件，放到网上，告诉你的朋友下载并安装到他们的设备上。
*   像专业人士一样，在 Android Market 上发布您的应用。

第一个选项是一个很好的方法，可以让其他人在您将应用投入市场之前对其进行测试。他们所需要做的就是获得`APK`文件并将其安装到他们的设备上。一旦你的游戏准备好了，真正的乐趣就开始了。

### 关于测试的一句话

正如我们在前面的章节中看到的，设备之间有各种不同。在你发布你的应用之前，确保它能在一些常见的设备和不同的 Android 版本上运行良好。可悲的是，在这一点上没有简单的方法做到这一点。我们很幸运地得到了几部手机，涵盖了不同的设备类别和代次，用于测试。不过，根据你的预算，这可能不是一个选项。你可能不得不依靠模拟器(但不要太多，因为它确实不可靠)，或者最好依靠几个朋友来帮助你。

另一种测试你的应用的方法是在 Android Market 上放一个测试版。您可以在标题中清楚地将您的应用标记为 beta，这样用户就知道会发生什么。当然，一些用户会很乐意忽略所有的警告，仍然抱怨你潜在的未完成的应用的质量。这就是生活，你可能不得不面对负面的和不公正的评论。但是请记住:你的用户才是王道。不要生他们的气——而是想办法改进你的应用。

以下是我们在应用发布前常用的测试设备列表:

*   三星 Galaxy Leo/I5801，320×240 像素屏幕
*   HTC Hero 搭载 Android 1.5，480×320 像素屏幕
*   搭载安卓 1.6，480×320 像素屏幕的 HTC G1
*   摩托罗拉 Milestone/Droid 搭载 Android 2.1，854×480 像素屏幕
*   HTC Desire HD 采用 Android 2.2，800×480 像素屏幕
*   Nexus One 搭载 Android 2.3，800×480 像素屏幕
*   搭载 Android 2.3 的三星 Galaxy S，800×480 像素屏幕
*   三星 Galaxy Tab 10.1 搭载 Android 3.1，1280×800 像素屏幕

如你所见，我们涵盖了相当多的屏幕尺寸/分辨率和设备代。如果你寻找外部测试人员，确保你覆盖了这里列出的大多数设备。当然，更新的设备也应该在你的列表中，但更多的是为了兼容性测试，而不是性能测试。

最后，您必须接受这样一个事实，即您无法在所有设备上测试您的应用。您很可能会收到莫名其妙的错误报告，这很可能是因为用户运行的自定义 rom 的行为不符合预期。无论如何，不要慌；这在某种程度上是正常的。但是，如果错误的问题变得太严重，你就必须想出一个方案来解决它。幸运的是，Android Market 在这方面帮助了我们。我们一会儿会看到它是如何工作的。

**注意:**除了 Android Market 的错误报告功能，还有另一个很好的解决方案叫做 ACRA(Android 的应用崩溃报告)，这是一个开源库，专门用来报告你的 Android 应用的所有崩溃。它在`[http://code.google.com/p/acra/](http://code.google.com/p/acra/)`有售，非常容易使用。只需按照 Google 代码页上的指南将其集成到您的应用中。

### 成为注册开发者

谷歌使得在官方 Android 市场上发布你的应用变得非常容易。你所要做的就是一次性支付 25 美元注册一个 Android 开发者账户。根据您所在的国家，该帐户允许您将免费和/或付费应用投放市场。谷歌正在努力扩大你可以销售应用的国家的数量。

要注册账户，请访问`[https://market.android.com/publish/signup](https://market.android.com/publish/signup)`并按照那里的指示进行操作。

除了你的 Android 开发者账户，如果你想出售你的应用，你还需要注册一个免费的 Google Checkout 商家账户。在开发者帐户注册过程中，您可以选择这样做。我们不是律师，所以在这一点上我们不能给你任何法律建议。在出售应用之前，请确保您了解其法律含义。如果有疑问，考虑就此事咨询专家。我们无意以此吓退你，因为这个过程总体来说非常简单，但是你应该准备好让你政府的税务部门知道你在做什么。

谷歌将从你的血汗钱中抽取 30%用于分发你的应用和提供基础设施。这似乎是各种平台上所有应用商店的标准做法。

### 为你的游戏 APK 签名

成功注册成为 Android 官方开发者后，就该准备发布应用了。为了发布你的申请，你必须签署 APK 文件。在你这样做之前，你应该确保一切就绪。下面是在签署申请之前要做的一系列事情:

*   从清单文件的`<application>`标签中删除`android:debuggable`属性。
*   在`<manifest>`标签中，您会发现`android:versionCode`和`android:versionName`属性。如果您已经发布了应用的先前版本，那么您必须增加`versionCode`属性，并且您还应该更改`versionName`。`versionCode`属性必须是整数；`versionName`可以是你喜欢的任何东西。
*   如果你的构建目标等于或高于 SDK level 8 (Android 2.2)，你还应该确保`<manifest>`标签的`android:installLocation`属性设置为`preferExternal`或`auto`。这将通过确保您的应用尽可能安装在外部存储上来满足您的用户。
*   确保只指定游戏真正需要的权限。用户不喜欢安装似乎要求不必要权限的应用。检查清单文件中的`<uses-permission>`标签。
*   确认您正确设置了`android:minSdkVersion`和`android:targetSdkVersion`。您的应用将仅在 Android Market 中运行 Android 版本等于或高于指定 SDK 版本的手机上可见。

*仔细检查*所有这些项目。完成后，您可以按照以下步骤最终导出一个已签名的`APK`文件，准备上传到市场:

1.  Right-click your project in the package explorer view and select Android **Tools ![images](img/U001.jpg) Export Signed Application Package**. You'll be greeted with the dialog shown in [Figure 13–1](#fig_13_1). ![images](img/1301.jpg)

    **图 13–1。** *已签署的导出对话框*

2.  Click the `Next` button to bring up the dialog shown in [Figure 13–2](#fig_13_2). ![images](img/1302.jpg)

    **图 13–2。** *选择或创建密钥库*

3.  A *keystore* is a password-protected file that stores the key with which you sign your `APK` file. Since you haven't created one yet, you'll do so now in this dialog. Just provide the location of the keystore, along with the password that you will use to secure it. If you have already created a keystore (for example, if you're publishing a second version of your application), you can select the `Use existing keystore` radio button and simply provide the dialog with the location of the keystore file. Click the `Next` button to bring up the dialog shown in [Figure 13–3](#fig_13_3). ![images](img/1303.jpg)

    **图 13–3。** *创建用于签署*的密钥`APK`

4.  To create a valid key, you have to fill out the alias, password, and validity in years, as well as a name in the `First and Last Name`field. The rest is optional, but it's a good idea to fill it out nevertheless. Another click on `Next`, and you are shown the final dialog (see [Figure 13–4](#fig_13_4)). ![images](img/1304.jpg)

    **图 13–4。**T3 指定目标文件

5.  现在，你基本上完成了。只需指定导出的`APK`文件应该存储在哪里，并记住路径。当你想把那个`APK`上传到市场时，你会需要它。

当您想要发布以前发布的应用的新版本时，您可以重用第一次浏览对话框时创建的密钥库。在如图[Figure 13–2](#fig_13_2)所示的对话框中，只需选择您之前创建的密钥库文件，并提供密钥库的密码。然后你会看到[图 13–5](#fig_13_5)中的对话框。

只需选择您之前创建的密钥，为其提供密码，然后像之前一样继续操作。在这两种情况下，结果都是一个已签名的`APK`文件，可以上传到 Android Market。

**注意:**一旦你上传了一个已签名的`APK`，你必须使用相同的密钥来签署同一应用的任何后续版本。

![images](img/1305.jpg)

**图 13–5。**T3】重用一个密钥

那么，你已经创建了你的第一个签名`APK`——祝贺你！现在让我们把扳手扔进工作中，并通知你市场的多重`APK`支持。对于单个应用，您可以创建多个使用设备功能过滤的`APK`,以便为安装您应用的每个用户找到“最佳选择”。这是一个很棒的功能，因为这意味着您可以做如下事情:

*   提供与特定 GPU 兼容的特定映像集。
*   针对旧版本 Android 的有限功能集。
*   为更大的屏幕尺寸提供更大比例的图形，为所有其他屏幕尺寸提供常规比例的图形。

随着时间的推移，谷歌肯定会添加更多的过滤器，但这里概述的一套过滤器可以让你真正专注于目标设备(如平板电脑)，而不必通过太多的限制来保持第一代设备支持的合理下载量。

### 将你的游戏推向市场

是时候在 Android Market 网站上登录您的开发者帐户了。只需前往`[http://market.android.com/publish](http://market.android.com/publish)`并登录即可。你会看到如图[图 13–6](#fig_13_6)所示的界面。

![images](img/1306.jpg)

**图 13–6。** *欢迎来到安卓市场，开发者！*

这就是 Android 所说的*开发者控制台*，我们一会儿会谈到它。现在，让我们集中精力发布您的应用。`Upload Application`按钮可以让你这样做。让我们浏览一下上传页面的一些部分，第一部分如图[图 13–7](#fig_13_7)所示。

![images](img/1307.jpg)

**图 13–7。** *在安卓开发者控制台上编辑应用屏幕片段*

#### 上传素材

首先要指定的是刚刚签名并导出的`APK`文件。只需选择文件，并点击`Upload`按钮。与此同时，您可以继续上传剩余的素材，因为`APK`将继续在后台上传。一旦`APK`上传，系统会对其进行检查，并在同一页面上向您报告任何错误。

你还必须提供至少两张你的应用截图。它们必须是某种格式(`JPEG`或`PNG`)和大小(320×480、480×800、480×854、1280×720 或 1280×800)。当用户在 Android Market 上(在手机应用上和在`[http://market.android.com](http://market.android.com)`的官方网站上)查看您的应用的详细信息时，这些信息会显示出来。

接下来，你必须上传一个 512×512、高分辨率的应用图标`PNG`或`JPEG`。目前，这仅在用户在 Android Market 网站上查看您的应用时显示。弄得花哨一点。

如果你的游戏是有特色的，宣传图片(180×120，`PNG`或`JPEG`)和特色图片(1024×500)会出现在 Android Market 上。成为特色是一件大事，因为这意味着当用户在移动应用或网站上打开 Android 市场时，你的应用将是他们看到的第一样东西。谁被选中取决于谷歌，只有他们知道这个决定的依据。

最后，你可以提供一个应用的 YouTube 推广视频的链接。这将出现在 Android Market 网站上。请注意，Android Market 开发者界面不断变化，可能会包括此处未列出的其他功能。

#### 产品详情

在将在 Android Market 上向用户显示的产品详细信息部分，您可以用多种语言指定应用的标题(最多 30 个字符)和可选描述(最多 4000 个字符)。

额外的 500 个字符可用于通知用户应用最新版本中的最新更改。只有当您的应用成为特色时，才会使用推广文本。

接下来，您必须指定您的应用的类型和类别。对于每种应用类型，都有一系列类别可供选择。对于游戏，您可以指定街机和行动，大脑和益智，纸牌和赌场，休闲，或赛车和体育。选项让分类有点混乱(赛车不是运动？)，他们可以更好地思考。希望未来能有所改变。

最后，你要决定用户是否会为你的游戏付费。这是最终决定。一旦你实现了两个选项中的一个，你就不能改变它，除非你用不同的密钥重新发布你的游戏。如果你这样做，你会失去任何用户评论，你也会疏远你的用户。想想你的游戏要走的路线。我们不会给你游戏定价的建议，因为这取决于多种因素。0.99 美元的价格似乎是大多数游戏的标准，也是用户的期望。然而，没有什么能阻止你在这里尝试一下。

如果你出售你的游戏，确保你了解这样做所涉及的法律问题。

#### 发布选项

“发布选项”面板允许您指定是否要对应用进行版权保护、其内容分级以及您希望应用可用的位置。

版权保护功能几乎没有用，因为它可以通过遵循互联网上的几个指南轻松地绕过。谷歌将反对这种类型的版权保护，这将阻止用户从他们的设备上复制你的`APK`文件，并在网上免费提供。相反，Google 现在提供了一个 API 来将许可服务集成到您的应用中。这项服务是为了让用户更难盗版你的游戏。评估这项服务超出了本书的范围；如果你对盗版有疑虑，我们建议你去 Android 开发者网站。与许多数字版权管理(DRM)方案一样，用户报告了无法运行或安装使用许可服务的应用的问题。当然，对此不能全信。如果你需要的话，这是你目前 DRM 的最佳选择。

内容分级允许您指定您的目标受众。你可以通过点击发布页面上的`Learn More`链接找到关于给你自己的应用评级的指导方针。市场会根据你给它的内容评级来过滤你的应用。所以，仔细评估适合你游戏的评分。

最后，您可以选择应用可用的位置。当然，通常您希望它随处可用。然而，尽管这不太可能，但可能存在这样的情况，即您希望仅在选定的位置发布应用，这可能是出于法律原因。

#### 发布！

您将在发布页面上指定的最后几件事情是您的联系信息、您对 Android 内容指南的同意(链接在同一页面上，请阅读它们)，以及您同意美国出口法律的确认，这是您通常会做的。在提供了所有这些信息之后，是时候点击页面底部巨大的`Publish`按钮了！

全球数百万人将可以即时看到你的游戏。在 Android Market 上，你的应用将进入“最新”类别，只要它没有被其他新应用推下列表，用户就可以发现它。不要试图玩弄公正的机制；没用的。每隔几个小时上传一个“新”版本的应用不会导致你的应用出现在列表中。

#### 营销

虽然这超出了我们的专业领域，但这里有一些关于营销的想法。网络上围绕 Android 平台有一个健康的生态系统，包括新闻网站、博客、论坛等等。大多数博客和新闻网站都很乐意报道新游戏，所以要尽可能多的接触他们。还有一些游戏专用的 Android 网站，比如`[http://www.droidgamers.com](http://www.droidgamers.com)`，应该是你宣传的首要目标。没有一点市场营销，你的游戏不太可能被注意到，因为公正的列表是高度动态的。营销是游戏成功的一部分。成千上万的书都是关于这个话题的，但是我们认为没有神奇的公式。做出一个伟大的游戏，让人们了解它。

### 开发者控制台

一旦你的游戏上市，你会想跟踪它的状态。到目前为止有多少人下载了？发生过撞车事故吗？用户在说什么？您可以在开发人员控制台中检查所有这些(参见[图 13–6](#fig_13_6))。

对于您发布的每个应用，您可以获得一些信息:

*   您游戏的总体评分和评分数量
*   用户的评论(只需点击相应应用的`Comments`链接)
*   应用安装的次数
*   应用的活动安装数量
*   错误报告

我们对错误报告特别感兴趣。[图 13–8](#fig_13_8)显示了游戏 Newton 收到的错误报告。

![images](img/1308.jpg)

**图 13–8。** *错误报告概述*

总共有八次冻结和两次崩溃。牛顿已经上市一年多了，所以还不错。当然，您可以进一步深入到具体的错误。开发人员控制台的错误报告功能将为您提供关于崩溃和冻结的详细信息，例如发生问题的设备型号、完整的堆栈跟踪等等。当你试图找出你的应用到底出了什么问题时，这可能会有很大的帮助。对市场的评论不会比一般的问题识别有更多的帮助。

**注意:**错误报告是一项设备端功能，旧版本的 Android 不支持。如前所述，如果你想完全确信你已经发现了所有问题，我们建议你去看看 ACRA。

### 总结

在市场上发布你的游戏轻而易举，而且进入门槛非常低。困难的部分是让人们意识到你的游戏，这是一个我们无法帮助你的任务。你现在已经掌握了在 Android 上设计、实现和发布你的第一个游戏的所有必要知识。愿原力与你同在！